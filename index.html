<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>反射する点ゲーム</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        .board {
            display: grid;
            grid-template-columns: repeat(100, 10px);
            grid-template-rows: repeat(100, 10px);
            gap: 1px;
            border: 2px solid black;
            position: relative;
            background-color: white;
        }
        .grid-line {
            background-color: black;
        }
        .dot {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: black;
            border-radius: 50%;
        }
        button {
            margin: 10px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="controls">
        <button onclick="startGame()">開始</button>
        <button onclick="stopGame()">停止</button>
        <button onclick="resetBoard()">リセット</button>
    </div>
    <div class="board" id="board"></div>

    <script>
        const board = document.getElementById("board");
        const gridSize = 100;
        const dots = [];
        let gameInterval;
        let dotSpeed = 50;  // 1秒間に50マス

        // 点の初期設定
        function createDot() {
            return {
                x: Math.floor(Math.random() * gridSize),
                y: Math.floor(Math.random() * gridSize),
                dx: Math.random() > 0.5 ? 1 : -1,
                dy: Math.random() > 0.5 ? 1 : -1,
                element: null
            };
        }

        // 盤面の初期化
        function initBoard() {
            board.innerHTML = "";
            for (let i = 0; i < gridSize; i++) {
                for (let j = 0; j < gridSize; j++) {
                    let gridCell = document.createElement("div");
                    gridCell.classList.add("grid-line");
                    board.appendChild(gridCell);
                }
            }
        }

        // 点を配置
        function placeDots() {
            for (let i = 0; i < 10; i++) {
                let dot = createDot();
                dot.element = document.createElement("div");
                dot.element.classList.add("dot");
                board.appendChild(dot.element);
                dots.push(dot);
            }
        }

        // 点の動き
        function moveDots() {
            dots.forEach(dot => {
                dot.x += dot.dx;
                dot.y += dot.dy;

                // 盤面の端で跳ね返る
                if (dot.x >= gridSize || dot.x < 0) dot.dx = -dot.dx;
                if (dot.y >= gridSize || dot.y < 0) dot.dy = -dot.dy;

                // 点同士がぶつかると跳ね返る
                dots.forEach(otherDot => {
                    if (dot !== otherDot && Math.abs(dot.x - otherDot.x) <= 1 && Math.abs(dot.y - otherDot.y) <= 1) {
                        dot.dx = -dot.dx;
                        dot.dy = -dot.dy;
                    }
                });

                // 点の位置を更新
                dot.element.style.left = `${dot.x * 10}px`;
                dot.element.style.top = `${dot.y * 10}px`;
            });
        }

        // ゲーム開始
        function startGame() {
            initBoard();
            placeDots();
            gameInterval = setInterval(() => {
                moveDots();
            }, 1000 / dotSpeed);  // 50マス/秒
            setTimeout(resetBoard, 60000);  // 1分ごとにリセット
        }

        // ゲーム停止
        function stopGame() {
            clearInterval(gameInterval);
        }

        // 盤面リセット
        function resetBoard() {
            clearInterval(gameInterval);
            dots.length = 0;
            initBoard();
            setTimeout(startGame, 500);  // ゲーム再開始
        }
    </script>
</body>
</html>
