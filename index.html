<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>反射する点のゲーム</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: white;
        }

        #board {
            width: 600px;
            height: 600px;
            position: relative;
            background-color: white;
            border: 2px solid black;
            display: grid;
            grid-template-columns: repeat(100, 1fr);
            grid-template-rows: repeat(100, 1fr);
            border-collapse: collapse;
        }

        .grid-line {
            position: absolute;
            border-color: lightgray;
            width: 100%;
            height: 100%;
        }

        .point {
            position: absolute;
            width: 6px;
            height: 6px;
            background-color: black;
            border-radius: 50%;
        }

        button {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }

    </style>
</head>
<body>

<div id="board"></div>

<button onclick="startGame()">開始</button>
<button onclick="stopGame()">停止</button>
<button onclick="resetBoard()">リセット</button>

<script>
    const board = document.getElementById('board');
    const points = [];
    let gameInterval;
    let resetInterval;
    let isRunning = false;

    // 盤面のグリッドを生成
    function createGrid() {
        for (let i = 0; i < 100; i++) {
            for (let j = 0; j < 100; j++) {
                const gridCell = document.createElement('div');
                gridCell.classList.add('grid-line');
                gridCell.style.top = `${i * 6}px`;
                gridCell.style.left = `${j * 6}px`;
                board.appendChild(gridCell);
            }
        }
    }

    // 点の初期化
    function createPoints() {
        for (let i = 0; i < 10; i++) {
            const point = document.createElement('div');
            point.classList.add('point');
            const x = Math.floor(Math.random() * 100);
            const y = Math.floor(Math.random() * 100);
            point.style.left = `${x * 6}px`;
            point.style.top = `${y * 6}px`;

            // ランダムな速度
            point.speedX = Math.floor(Math.random() * 31) + 20; // 20～50マス/秒
            point.speedY = Math.floor(Math.random() * 31) + 20; // 20～50マス/秒

            points.push(point);
            board.appendChild(point);
        }
    }

    // 点の動きを更新
    function updatePoints() {
        points.forEach(point => {
            const xPos = parseInt(point.style.left, 10) / 6;
            const yPos = parseInt(point.style.top, 10) / 6;

            // 端にぶつかった場合の反射
            if (xPos <= 0 || xPos >= 99) point.speedX = -point.speedX;
            if (yPos <= 0 || yPos >= 99) point.speedY = -point.speedY;

            // 他の点とぶつかった場合の反射
            points.forEach(otherPoint => {
                if (point !== otherPoint) {
                    const dx = Math.abs(xPos - parseInt(otherPoint.style.left, 10) / 6);
                    const dy = Math.abs(yPos - parseInt(otherPoint.style.top, 10) / 6);
                    if (dx < 1 && dy < 1) {
                        point.speedX = -point.speedX;
                        point.speedY = -point.speedY;
                    }
                }
            });

            // 点の位置更新
            point.style.left = `${xPos + point.speedX / 60}px`;
            point.style.top = `${yPos + point.speedY / 60}px`;
        });
    }

    // ゲーム開始
    function startGame() {
        if (isRunning) return;
        isRunning = true;
        gameInterval = setInterval(updatePoints, 1000 / 60);
    }

    // ゲーム停止
    function stopGame() {
        isRunning = false;
        clearInterval(gameInterval);
    }

    // 盤面リセット
    function resetBoard() {
        points.forEach(point => point.remove());
        points.length = 0;
        createPoints();
    }

    // 1分ごとに盤面を自動リセット
    function autoReset() {
        resetInterval = setInterval(resetBoard, 60000);
    }

    // 初期化
    createGrid();
    createPoints();
    autoReset();

</script>

</body>
</html>
