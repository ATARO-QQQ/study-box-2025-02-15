<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>モノクロ盤面ゲーム</title>
  <style>
    body {
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #f0f0f0;
    }

    #board {
      display: grid;
      grid-template-columns: repeat(100, 1fr);
      grid-template-rows: repeat(100, 1fr);
      width: 500px;
      height: 500px;
      border: 3px solid black;
      position: relative;
      background-color: white;
    }

    .cell {
      border: 0.5px solid lightgray;
    }

    .dot {
      position: absolute;
      width: 100%;
      height: 100%;
      background-color: black;
    }

    button {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>

<div id="board"></div>
<button id="startBtn">開始</button>
<button id="stopBtn">停止</button>
<button id="resetBtn">リセット</button>

<script>
  const boardSize = 100;
  const dotCount = 10;
  const cellSize = 5; // each cell size in px
  let dots = [];
  let interval;
  let isRunning = false;

  // 盤面の作成
  const board = document.getElementById("board");
  for (let i = 0; i < boardSize * boardSize; i++) {
    const cell = document.createElement("div");
    cell.classList.add("cell");
    board.appendChild(cell);
  }

  // 点の生成
  function createDots() {
    dots = [];
    for (let i = 0; i < dotCount; i++) {
      const dot = document.createElement("div");
      dot.classList.add("dot");
      dot.style.width = `${cellSize}px`;
      dot.style.height = `${cellSize}px`;

      const x = Math.floor(Math.random() * boardSize);
      const y = Math.floor(Math.random() * boardSize);
      const speed = Math.floor(Math.random() * 31) + 20; // 20～50マス/秒

      dot.style.left = `${x * cellSize}px`;
      dot.style.top = `${y * cellSize}px`;

      dots.push({ dot, x, y, speed, dx: 1, dy: 1 });
      board.appendChild(dot);
    }
  }

  // 点の移動
  function moveDots() {
    dots.forEach(dotObj => {
      let { dot, x, y, speed, dx, dy } = dotObj;
      
      // 点の移動
      x += dx * speed / 50;
      y += dy * speed / 50;

      // 端で跳ね返り
      if (x >= boardSize - 1 || x < 0) dx *= -1;
      if (y >= boardSize - 1 || y < 0) dy *= -1;

      // 点同士の衝突を避ける処理
      dots.forEach(otherDotObj => {
        if (dot !== otherDotObj.dot) {
          const distX = Math.abs(otherDotObj.x - x);
          const distY = Math.abs(otherDotObj.y - y);
          if (distX < 1 && distY < 1) {
            dx *= -1;
            dy *= -1;
          }
        }
      });

      // 点の位置更新
      dotObj.x = x;
      dotObj.y = y;
      dotObj.dx = dx;
      dotObj.dy = dy;

      dot.style.left = `${x * cellSize}px`;
      dot.style.top = `${y * cellSize}px`;
    });
  }

  // リセット処理
  function resetBoard() {
    clearInterval(interval);
    board.innerHTML = '';
    for (let i = 0; i < boardSize * boardSize; i++) {
      const cell = document.createElement("div");
      cell.classList.add("cell");
      board.appendChild(cell);
    }
    createDots();
    startGame(); // リセット後にゲームを自動で開始
  }

  // ゲーム開始
  function startGame() {
    if (!isRunning) {
      isRunning = true;
      interval = setInterval(() => {
        moveDots();
      }, 1000 / 50);
    }
  }

  // ゲーム停止
  function stopGame() {
    clearInterval(interval);
    isRunning = false;
  }

  // ボタン操作
  document.getElementById("startBtn").addEventListener("click", startGame);
  document.getElementById("stopBtn").addEventListener("click", stopGame);
  document.getElementById("resetBtn").addEventListener("click", resetBoard);

  // 1分ごとにリセット
  setInterval(resetBoard, 60000);

  // 初期化
  resetBoard();
</script>

</body>
</html>
